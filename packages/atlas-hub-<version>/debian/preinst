#!/bin/sh

BASE_DIR="/usr/lib/atlas-hub"

RED=$(printf '\033[31m')

if ! which node > /dev/null; then
  echo
  echo "${RED}Error: Node is not installed. Please install node and try again. See https://learnubuntu.com/install-node/ for help.${RESET}"
  echo
  exit 1
fi

if ! which npm > /dev/null; then
  echo
  echo "${RED}Error: Npm is not installed. Please install node and try again. See https://learnubuntu.com/install-node/ for help.${RESET}"
  echo
  exit 1
fi

# remove old install
if [ -d "$BASE_DIR" ]; then
    cd "${BASE_DIR:?}" || exit; rm -rf *
fi

# create log directory
mkdir -p "/var/log/atlas-hub"

# create log files
touch /var/log/atlas-hub/supervisord.log
touch /var/log/atlas-hub/error.log
touch /var/log/atlas-hub/access.log

chown -R www-data /var/log/atlas-hub

### proceed with install ###
